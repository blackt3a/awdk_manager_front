import{_ as B,f as v,c as S,a as l,w as o,g as $,h as p,r as i,o as C,b as s,t as r,e as b,i as D}from"./index-w83zdtlJ.js";const k={name:"Challenge",data(){return{isLoading:!0,challengeList:null,newChallengeDialogVisible:!1,editChallengeDialogVisible:!1,newChallengeForm:{Title:"",BaseScore:1e3,AutoRefreshFlag:!1,Command:"echo {{FLAG}} > /flag"},editChallengeForm:{Title:"",BaseScore:1e3,AutoRefreshFlag:!1,Command:""}}},mounted(){this.getChallenges()},methods:{getChallenges(){this.utils.GET("/manager/challenges").then(e=>{this.challengeList=e,this.isLoading=!1}).catch(e=>this.$message.error(e))},onNewChallenge(){this.utils.POST("/manager/challenge",this.newChallengeForm).then(e=>{this.newChallengeDialogVisible=!1,this.newChallengeForm={Title:"",BaseScore:1e3,AutoRefreshFlag:!1,Command:"echo {{FLAG}} > /flag"},this.getChallenges(),this.$message({message:e,type:"success"})}).catch(e=>this.$message({message:e,type:"error"}))},onEditChallenge(){this.utils.PUT("/manager/challenge",this.editChallengeForm).then(e=>{this.editChallengeDialogVisible=!1,this.getChallenges(),this.$message({message:e,type:"success"})}).catch(e=>this.$message({message:e,type:"error"}))},handleDelete(e){this.utils.DELETE("/manager/challenge?id="+e.ID).then(t=>{this.$message({message:t,type:"success"}),this.getChallenges()}).catch(t=>this.$message({message:t,type:"error"}))},handleVisible(e,t){this.utils.POST("/manager/challenge/visible",{ID:e,Visible:t}).then(u=>{this.$message({message:u,type:"success"}),this.getChallenges()}).catch(u=>this.$message({message:u,type:"error"}))}}},L=b("code",null,"{{FLAG}}",-1),R=b("code",null,"{{FLAG}}",-1);function U(e,t,u,N,a,d){const h=i("el-button"),m=i("el-table-column"),c=i("el-popconfirm"),y=i("el-table"),f=i("el-input"),g=i("el-form-item"),V=i("el-input-number"),F=i("el-switch"),w=i("el-form"),_=i("el-dialog"),T=v("loading");return C(),S("div",null,[l(h,{type:"primary",onClick:t[0]||(t[0]=n=>a.newChallengeDialogVisible=!0)},{default:o(()=>[s(r(e.$t("challenge.new")),1)]),_:1}),$((C(),p(y,{data:a.challengeList,style:{width:"100%"},stripe:""},{default:o(()=>[l(m,{width:"80",prop:"ID",label:"ID"}),l(m,{prop:"Title",label:e.$t("challenge.title")},null,8,["label"]),l(m,{prop:"BaseScore",label:e.$t("challenge.base_score")},null,8,["label"]),l(m,{prop:"Visible",label:e.$t("challenge.visible")},{default:o(n=>[s(r(n.row.Visible),1)]),_:1},8,["label"]),l(m,{prop:"AutoRefreshFlag",label:e.$t("challenge.auto_refresh_flag")},{default:o(n=>[s(r(n.row.AutoRefreshFlag),1)]),_:1},8,["label"]),l(m,{prop:"Command",label:e.$t("challenge.command")},null,8,["label"]),l(m,{label:e.$t("general.create_at"),width:"200",formatter:n=>e.utils.FormatGoTime(n.CreatedAt)},null,8,["label","formatter"]),l(m,{label:e.$t("general.operate"),width:"300"},{default:o(n=>[l(c,{title:n.row.Visible?e.$t("challenge.invisible_title"):e.$t("challenge.visible_title"),onOnConfirm:A=>d.handleVisible(n.row.ID,!n.row.Visible)},{reference:o(()=>[l(h,{plain:"",size:"mini"},{default:o(()=>[s(r(e.$t("challenge.set_visible")),1)]),_:1})]),_:2},1032,["title","onOnConfirm"]),l(h,{size:"mini",onClick:()=>{a.editChallengeForm=JSON.parse(JSON.stringify(n.row)),a.editChallengeDialogVisible=!0}},{default:o(()=>[s(r(e.$t("general.edit")),1)]),_:2},1032,["onClick"]),l(c,{confirmButtonText:e.$t("general.confirm_cancel"),cancelButtonText:e.$t("general.cancel"),icon:"el-icon-info",iconColor:"red",title:e.$t("challenge.delete_title"),onOnConfirm:A=>d.handleDelete(n.row)},{reference:o(()=>[l(h,{size:"mini",type:"danger"},{default:o(()=>[s(r(e.$t("general.delete")),1)]),_:1})]),_:2},1032,["confirmButtonText","cancelButtonText","title","onOnConfirm"])]),_:1},8,["label"])]),_:1},8,["data"])),[[T,a.isLoading]]),l(_,{title:e.$t("challenge.publish"),modelValue:a.newChallengeDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=n=>a.newChallengeDialogVisible=n)},{default:o(()=>[l(w,{model:a.newChallengeForm,"label-width":"120px"},{default:o(()=>[l(g,{label:e.$t("challenge.title")},{default:o(()=>[l(f,{modelValue:a.newChallengeForm.Title,"onUpdate:modelValue":t[1]||(t[1]=n=>a.newChallengeForm.Title=n)},null,8,["modelValue"])]),_:1},8,["label"]),l(g,{label:e.$t("challenge.base_score")},{default:o(()=>[l(V,{modelValue:a.newChallengeForm.BaseScore,"onUpdate:modelValue":t[2]||(t[2]=n=>a.newChallengeForm.BaseScore=n),min:1},null,8,["modelValue"])]),_:1},8,["label"]),l(g,{label:e.$t("challenge.auto_refresh_flag")},{default:o(()=>[l(F,{modelValue:a.newChallengeForm.AutoRefreshFlag,"onUpdate:modelValue":t[3]||(t[3]=n=>a.newChallengeForm.AutoRefreshFlag=n)},null,8,["modelValue"])]),_:1},8,["label"]),a.newChallengeForm.AutoRefreshFlag?(C(),p(g,{key:0,label:e.$t("challenge.command")},{default:o(()=>[l(f,{modelValue:a.newChallengeForm.Command,"onUpdate:modelValue":t[4]||(t[4]=n=>a.newChallengeForm.Command=n)},null,8,["modelValue"]),b("span",null,[s(r(e.$t("challenge.flag_placeholder")),1),L])]),_:1},8,["label"])):D("",!0)]),_:1},8,["model"]),l(h,{type:"primary",onClick:d.onNewChallenge},{default:o(()=>[s(r(e.$t("challenge.publish")),1)]),_:1},8,["onClick"])]),_:1},8,["title","modelValue"]),l(_,{title:e.$t("challenge.edit"),modelValue:a.editChallengeDialogVisible,"onUpdate:modelValue":t[10]||(t[10]=n=>a.editChallengeDialogVisible=n)},{default:o(()=>[l(w,{model:a.editChallengeForm,"label-width":"120px"},{default:o(()=>[l(g,{label:e.$t("challenge.title")},{default:o(()=>[l(f,{modelValue:a.editChallengeForm.Title,"onUpdate:modelValue":t[6]||(t[6]=n=>a.editChallengeForm.Title=n)},null,8,["modelValue"])]),_:1},8,["label"]),l(g,{label:e.$t("challenge.base_score")},{default:o(()=>[l(V,{modelValue:a.editChallengeForm.BaseScore,"onUpdate:modelValue":t[7]||(t[7]=n=>a.editChallengeForm.BaseScore=n),min:1},null,8,["modelValue"])]),_:1},8,["label"]),l(g,{label:e.$t("challenge.auto_refresh_flag")},{default:o(()=>[l(F,{modelValue:a.editChallengeForm.AutoRefreshFlag,"onUpdate:modelValue":t[8]||(t[8]=n=>a.editChallengeForm.AutoRefreshFlag=n)},null,8,["modelValue"])]),_:1},8,["label"]),a.editChallengeForm.AutoRefreshFlag?(C(),p(g,{key:0,label:e.$t("challenge.command")},{default:o(()=>[l(f,{modelValue:a.editChallengeForm.Command,"onUpdate:modelValue":t[9]||(t[9]=n=>a.editChallengeForm.Command=n)},null,8,["modelValue"]),b("span",null,[s(r(e.$t("challenge.flag_placeholder")),1),R])]),_:1},8,["label"])):D("",!0)]),_:1},8,["model"]),l(h,{type:"primary",onClick:d.onEditChallenge},{default:o(()=>[s(r(e.$t("challenge.edit")),1)]),_:1},8,["onClick"])]),_:1},8,["title","modelValue"])])}const E=B(k,[["render",U]]);export{E as default};
